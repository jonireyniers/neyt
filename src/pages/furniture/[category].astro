---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getFurnitureByCategory } from '../../lib/supabase';

export async function getStaticPaths() {
  return [
    { params: { category: 'adult-bedrooms' } },
    { params: { category: 'youth-bedrooms' } },
    { params: { category: 'baby-bedrooms' } },
    { params: { category: 'office' } },
    { params: { category: 'dining' } },
  ];
}

const { category } = Astro.params;
const locale: 'en' | 'fr' | 'nl' = 'nl';
const furniture = await getFurnitureByCategory(category);

console.log('=== DEBUG ===');
console.log('Category:', category);
console.log('Furniture count:', furniture.length);
console.log('Furniture:', JSON.stringify(furniture, null, 2));

const categoryLabels = {
  'adult-bedrooms': 'Volwassen Slaapkamers',
  'youth-bedrooms': 'Jeugd Slaapkamers',
  'baby-bedrooms': 'Baby Slaapkamers',
  'office': 'Kantoren',
  'dining': 'Eetkamers'
};
---

<BaseLayout title={categoryLabels[category]} locale={locale}>
  <Header locale={locale} />

  <main class="section">
    <div class="container">
      <h1 class="text-3xl font-serif font-bold mb-8">{categoryLabels[category]}</h1>

      <p>Aantal items: {furniture.length}</p>

      <pre class="bg-gray-100 p-4 rounded mb-4 overflow-auto">
        {JSON.stringify(furniture, null, 2)}
      </pre>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {furniture.map((item) => {
          const images = item.images || [item.image_url];
          return (
            <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition">
              <img 
                src={item.image_url} 
                alt={item.name_nl}
                class="w-full h-64 object-cover"
              />
              <div class="p-4">
                <h3 class="font-semibold text-lg mb-2">{item.name_nl}</h3>
                {item.name_fr && <p class="text-sm text-gray-500">{item.name_fr}</p>}
                {item.name_en && <p class="text-sm text-gray-500">{item.name_en}</p>}
                
                {item.pdf_url && (
                  <a 
                    href={item.pdf_url} 
                    target="_blank"
                    class="mt-3 inline-flex items-center gap-2 px-4 py-2 bg-accent text-white rounded-md hover:bg-accent/90 transition text-sm font-medium"
                  >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    Download technische tekening
                  </a>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </main>

  <Footer locale={locale} />
</BaseLayout>